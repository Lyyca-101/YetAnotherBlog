---
title: paper-reading[FAST2016-CFFS]
---
<h2>[FAST2016]The Composite-file File System:
Decoupling the One-to-One Mapping
of Files and Metadata for Better Performance</h2>

现状：

- 每个逻辑文件都被映射到它自己的一个物理元数据以及数据表示
- 也就是一个1-to-1的文件-元数据映射
- 对很多的文件系统机制而言，这是一个自然的粒度(granularity)

根据作者的观察(observation)，这种1-to-1的映射可能错失了很多优化的机会，主要的观察有四个：

- 对小文件的频繁访问：作者的桌面文件系统分析表明，>80%的访问落在大小<32B的小文件上，而在对这些盘上的小文件数据的访问时间中，对元数据的访问时间占了40%，因此，减少这部分的访问开销将带来巨大的性能提升
- 冗余的元数据信息：传统文件关联的元数据，会记录文件的数据块位置、访问权限等，许多文件其实拥有相同或类似的文件属性，对于一些文件属性(访问权限、所有者等)，其可能情况是明显有限的，因此会有大量的文件在这些属性上相似，一个研究表明，对一个工作站的元数据进行压缩，压缩率达到75%(per-inode,128B-->15-20B)，有很多机会去减少冗余的元数据，从而提高空间利用率
- 成组访问文件：很多研究表明，文件倾向于被一起访问，但是仅仅将文件分组并不能得到性能提升，应为识别可分租的文件以及将文件分组会带来额外的开销
- 预取的局限：尽管预取是一个有效的优化手段，但是提取文件数据-文件元数据的分离动作会导致极大的额外开销，比如，32个小文件和1个和32个小文件一样大的单文件，访问前者的延迟会比后者高50%，哪怕是在已经被缓存的情况下

那么，如何减少对元数据的额外访问开销，减少相似元数据占用的空间，低开销地成组访问文件，作者提出一个idea，同时地去解决这些问题，即：

- 将一起访问的小文件组合在一起，解耦1-to-1的文件-元数据映射，构造many-to-1的文件-元数据映射

作者的设计：